# User Credit Management - Product Requirement Promptnn## OverviewnImplement a user credit management system that allows users to purchase, view, and use credits for accessing premium features. The system should include credit balance tracking, purchase history, and usage analytics.nn## Requirementsnn### Functional Requirementsn- [ ] Display user's current credit balancen- [ ] Show credit purchase history with dates and amountsn- [ ] Allow users to purchase credits with different packagesn- [ ] Track credit usage for premium featuresn- [ ] Provide credit usage analytics and reportsn- [ ] Implement credit expiration systemn- [ ] Send low credit balance notificationsnn### Non-Functional Requirementsn- Performance: Credit balance updates within 2 secondsn- Security: Secure payment processing and credit validationn- Accessibility: WCAG 2.1 AA compliance for credit management interfacenn## Technical Specificationsnn### Technology Stackn- Frontend: React with TypeScriptn- Backend: Supabase (PostgreSQL)n- UI Library: Tailwind CSS with shadcn/ui componentsn- State Management: React Context + TanStack Queryn- Payment Processing: Stripe integrationnn### Architecture Patternsn- State Management: React Context for auth, TanStack Query for server staten- API Patterns: RESTful API with Supabase clientn- Database Patterns: PostgreSQL with Row Level Security (RLS)nn## All Needed Contextnn### AI Documentation (Recommended)n- **file**: PRPs/ai_docs/react-typescript-conventions.mdn  **why**: Component structure, TypeScript patterns, and form handling conventionsn- **file**: PRPs/ai_docs/supabase-patterns.mdn  **why**: Database operations, authentication, and real-time subscription patternsn- **file**: PRPs/ai_docs/admin-dashboard-patterns.mdn  **why**: Admin interface patterns and data visualization conventionsnn### Project Filesn- **file**: src/contexts/AuthContext.tsxn  **why**: Authentication context and user session managementn- **file**: src/integrations/supabase/client.tsn  **why**: Supabase client configuration and database connectionn- **file**: src/components/ui/card.tsxn  **why**: UI component patterns for credit display and formsnn### External Documentationn- **url**: https://supabase.com/docs/reference/javascript/selectn  **why**: Supabase query patterns and filtering optionsn- **url**: https://stripe.com/docs/stripe-jsn  **why**: Stripe payment integration patternsnn## Implementation Notesnn### Critical Requirementsn- [ ] CRITICAL: Implement Row Level Security (RLS) for credit data accessn- [ ] CRITICAL: Secure payment processing with proper error handlingn- [ ] IMPORTANT: Real-time credit balance updates using Supabase subscriptionsn- [ ] IMPORTANT: Responsive design for mobile credit managementn- [ ] NOTE: Consider credit expiration and renewal notificationsnn### Implementation Stepsn1. Create database schema for credits, purchases, and usage trackingn2. Implement credit balance display component with real-time updatesn3. Create credit purchase flow with Stripe integrationn4. Build credit usage tracking system for premium featuresn5. Develop credit analytics and reporting dashboardn6. Implement credit expiration and notification systemn7. Add comprehensive error handling and loading statesn8. Create unit tests for credit management functionsnn## Expected Outputnn### Code Quality Standardsn- [ ] Follows project TypeScript conventions with proper interfacesn- [ ] Implements proper error handling with user-friendly messagesn- [ ] Includes comprehensive testing with 80%+ coveragen- [ ] Follows accessibility guidelines with proper ARIA labelsn- [ ] Uses consistent naming conventions and code organizationnn### Deliverablesn- [ ] Credit balance display component with real-time updatesn- [ ] Credit purchase component with Stripe integrationn- [ ] Credit usage tracking systemn- [ ] Credit analytics dashboard componentn- [ ] Database schema and migration filesn- [ ] Unit tests for all credit management functionsn- [ ] Integration tests for payment flown- [ ] Documentation updates for credit systemnn## Success Criterian- [ ] Users can view their current credit balance in real-timen- [ ] Credit purchases process securely through Stripe integrationn- [ ] Credit usage is accurately tracked for premium featuresn- [ ] Admin dashboard displays comprehensive credit analyticsn- [ ] Low credit notifications are sent automaticallyn- [ ] All credit operations are protected by RLS policiesn- [ ] Mobile-responsive design works across all devicesn- [ ] Performance meets 2-second response time requirementn- [ ] Accessibility standards are met for all credit management featuresn- [ ] Test coverage exceeds 80% for credit management code